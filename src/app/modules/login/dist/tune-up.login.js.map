{"version":3,"file":"tune-up.login.js","sources":["../src/config/validations.js","../src/config/config.js","../src/services/login.service.js","../src/services/sites.service.js","../src/login.component.js","../src/login.routing.js","../src/components/siteselector/siteselector.component.js","../src/login.module.js"],"sourcesContent":["export const validations = {\n  login: {\n    email: [\n      {\n        isEmail: {\n          message: 'Debe ser un email vÃ¡lido'\n        }\n      }\n    ]\n  }\n};\n","import {configService} from '@tune-up/core';\nimport {validations} from './validations';\n\nconfigService.addValidations(validations);\n","import {Injectable} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\n\n@Injectable()\nexport class LoginService {\n  constructor(http: HttpClient) {\n    this._http = http;\n    this._url = 'Login2';\n  }\n  login(model) {\n    return this._http.post(this._url, model);\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\n\n@Injectable()\nexport class SitesService {\n  constructor(http: HttpClient) {\n    this._http = http;\n    this._url = 'Sitios';\n  }\n  get(email) {\n    return this._http.get(`${this._url}\\\\${email}`);\n  }\n}\n","import {Router, ActivatedRoute} from '@angular/router';\nimport {Component} from '@angular/core';\nimport {AuthService} from '@tune-up/app';\nimport {LoginService, SitesService} from './services';\nimport html from './login.component.html';\nimport './login.component.css';\n\n@Component({\n  selector: 'tn-login',\n  template: html,\n  providers: [LoginService, SitesService]\n})\nexport class LoginComponent {\n  model = {\n    email: undefined,\n    password: undefined,\n    idsitio: undefined\n  };\n  constructor(\n    route: ActivatedRoute,\n    router: Router,\n    loginService: LoginService,\n    sitesService: SitesService,\n    authService: AuthService\n  ) {\n    this._returnUrl = '/home';\n    this.sites = [];\n    this._route = route;\n    this._router = router;\n    this._loginService = loginService;\n    this._sitesService = sitesService;\n    this._authService = authService;\n  }\n  ngOnInit() {\n    this._returnUrl =\n      this._route.snapshot.queryParams.returnUrl || this._returnUrl;\n  }\n  onEmailFocusLost = () => {\n    this._sitesService.get(this.model.email).subscribe(\n      data => {\n        this.sites = data.Resultado.map(site => {\n          return {label: `${site.Id}: ${site.Nombre} `, value: site.Id};\n        });\n      },\n      error => {\n        console.log(error);\n      }\n    );\n  };\n  setIdSitio = idSitio => {\n    this.model.idsitio = idSitio;\n  };\n  showSelector = () => {\n    return this.sites.length > 1;\n  };\n  login = () => {\n    this._loginService.login(this.model).subscribe(\n      data => {\n        console.log(data);\n        this._authService.setToken(data.Resultado.Token);\n        this._router.navigateByUrl(this._returnUrl);\n      },\n      error => {\n        console.log(error);\n      }\n    );\n  };\n}\n","import {RouterModule} from '@angular/router';\nimport {NgModule} from '@angular/core';\nimport {LoginComponent} from './login.component';\n\n@NgModule({\n  imports: [RouterModule.forChild([{path: '', component: LoginComponent}])],\n  exports: [RouterModule]\n})\nexport class LoginRoutingModule {}\n","import {Component, Input, Output, EventEmitter} from '@angular/core';\nimport html from './siteselector.component.html';\n\n@Component({\n  selector: 'tn-site-selector',\n  template: html\n})\nexport class SiteSelectorComponent {\n  @Input() sites = [];\n  @Output() onSiteSelected = new EventEmitter();\n  selectSite = event => {\n    this.onSiteSelected.emit(event.value);\n  };\n}\n","import {NgModule} from '@angular/core';\nimport {LoginRoutingModule} from './login.routing';\nimport {LoginComponent} from './login.component';\nimport {SiteSelectorComponent} from './components';\nimport {TuneUpCoreModule} from '@tune-up/core';\n\n@NgModule({\n  imports: [TuneUpCoreModule, LoginRoutingModule],\n  declarations: [LoginComponent, SiteSelectorComponent]\n})\nexport class LoginModule {}\n"],"names":["validations","configService","addValidations","LoginService","Injectable","http","_http","_url","model","post","HttpClient","SitesService","email","get","LoginComponent","Component","html","route","router","loginService","sitesService","authService","undefined","onEmailFocusLost","_sitesService","subscribe","sites","data","Resultado","map","label","site","Id","Nombre","value","log","error","setIdSitio","idsitio","idSitio","showSelector","length","login","_loginService","_authService","setToken","Token","_router","navigateByUrl","_returnUrl","_route","snapshot","queryParams","returnUrl","ActivatedRoute","Router","AuthService","LoginRoutingModule","NgModule","RouterModule","forChild","path","component","SiteSelectorComponent","Input","Output","selectSite","onSiteSelected","emit","event","EventEmitter","LoginModule","TuneUpCoreModule"],"mappings":"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"}