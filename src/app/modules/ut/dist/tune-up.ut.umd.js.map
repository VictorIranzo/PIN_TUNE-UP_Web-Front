{"version":3,"file":"tune-up.ut.umd.js","sources":["../src/ut.component.js","../src/components/details/services/details.service.js","../src/components/details/details.component.js","../src/components/nuevaut/services/createUT.service.js","../src/components/nuevaut/services/getProductos.service.js","../src/components/nuevaut/services/getWorkflows.service.js","../src/components/nuevaut/nuevaut.component.js","../src/ut.routing.js","../src/ut.module.js"],"sourcesContent":["import {Component} from '@angular/core';\r\nimport html from './ut.component.html';\r\nimport './ut.component.css';\r\n\r\n@Component({\r\n  selector: 'tn-ut',\r\n  template: html,\r\n})\r\nexport class UtComponent {}\r\n","import {Injectable} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\n\n@Injectable()\nexport class DetailsService {\n  constructor(http: HttpClient) {\n    this._http = http;\n    this._urlUT = 'FichaUT2';\n    this._urlProductos = 'Productos2';\n    this._urlUTs = 'UTs2';\n  }\n\n  getUt(id) {\n    return this._http.get(`${this._urlUT}/${id}`);\n  }\n\n  getProductosDisponibles() {\n    return this._http.get(`${this._urlProductos}`);\n  }\n\n  submitChangesDetails(model) {\n    return this._http.post(this._urlUTs, model);\n  }\n}\n\n\n","import {Component} from '@angular/core';\nimport {ActivatedRoute} from '@angular/router';\nimport {DetailsService} from './services';\nimport {NotificationsService} from '@tune-up/core';\nimport html from './details.component.html';\nimport './details.component.css';\n\nconst utTypesIcons = {\n  1: 'fa fa-star',\n  2: 'fa fa-bug',\n  3: 'fa fa-plus-circle',\n  4: 'fa fa-puzzle-piece',\n};\n\n@Component({\n  selector: 'tn-ut-details',\n  template: html,\n})\nexport class DetailsComponent {\n  editingMode = false;\n  model = {IdUT: undefined, Nombre: undefined, Orden: undefined,\n          IdProducto: undefined, IdVersion: undefined, IdWorkflow: undefined,\n          IdTipoUT: undefined, IdProyecto: undefined, Descripcion: undefined};\n  ut = undefined;\n\n  // TODO: utiliza destructuring para que quede más claro, ej\n  // const {Nombre, Orden} = data.UT; const {listaVersiones,...} = data\n\n  constructor(route: ActivatedRoute,\n              detailsService: DetailsService,\n              notificationsService: NotificationsService) {\n        this._route = route;\n        this._detailsService = detailsService;\n        this._notificationsService = notificationsService;\n\n        this.model.IdUT= parseInt(this._route.params._value.id);\n\n        this._detailsService.getProductosDisponibles().subscribe((data) => {\n          this._parseProductos(data);\n        });\n\n        this._detailsService.getUt(this.model.IdUT).subscribe((data) => {\n              this.ut = data;\n              this.model.Nombre = data.UT.Nombre;\n              this.model.Orden = data.UT.Orden;\n              this._parseSprints(data.listaVersionesUT);\n              this._parseWorkflows(data.listaWorkflowsDisponibles);\n              this._parseTipos(data.listaTiposUT);\n              this._parseProyectos(data.listaProyectos);\n              this.model.Descripcion = data.UT.Descripcion;\n              this._mapSelected(data, this.model);\n            });\n  }\n  ngOnDestroy() {\n    this._getUtSub &&\n    !this._getUtSub.closed &&\n    this._getUtSub.unsubscribe();\n  }\n\n  onEditar() {\n    this.editingMode = true;\n  }\n\n  onCancelar() {\n    this.editingMode = false;\n\n    this.model.IdUT = this.ut.UT.IdUT;\n    this.model.Nombre = this.ut.UT.Nombre;\n    this.model.Orden = this.ut.UT.Orden;\n    this.model.IdProducto = this.ut.UT.IdProducto;\n    this.model.IdVersion = this.ut.UT.IdVersion;\n    this.model.IdWorkflow = this.ut.UT.IdWorkflow;\n    this.model.IdTipoUT = this.ut.UT.IdTipoUT;\n    this.model.IdProyecto = this.ut.UT.IdProyecto;\n    this.model.Descripcion = this.ut.UT.Descripcion;\n  }\n\n  onGuardar = () => {\n    this._saveDetailsSubscription = this._detailsService.submitChangesDetails(this.model).subscribe(\n      (data) => {\n        this.editingMode = false;\n      },\n      (error) => {\n        this._notificationsService.error('Error al guardar los cambios', error);\n      }\n    );\n  };\n\n  // TODO: var a = 'hola', label: a === label: `${a}`\n  // las template strings solo valen si vas a escribir más.\n  // TODO, en vez de almacenar todo esto en this, llama a las funciones desde el html y ya esta,\n  // que solo se van a llamar una vez\n  \n  _parseSprints(sprints) {\n    this.sprintsDisponibles = sprints.map((sprint) => {\n      return {label: `${sprint.Nombre}`, value: sprint.IdVersion};\n    });\n    this.sprintsDisponibles.push({label: 'Backlog', value: null});\n  }\n  _parseWorkflows(wfs) {\n    this.workflowsDisponibles = wfs.map((wf) => {\n      return {label: `${wf.Nombre}`, value: wf.IdWorkflow};\n    });\n  }\n  _parseTipos(tipos) {\n    this.tiposDisponibles = tipos.map((tipo) => {\n      return {label: `${tipo.Nombre}`, value: tipo.IdTipoUT};\n    });\n  }\n  _parseProyectos(proyectos) {\n    this.proyectosDisponibles = proyectos.map((proy) => {\n      return {label: `${proy.Nombre}`, value: proy.IdProyecto};\n    });\n    this.proyectosDisponibles.push({label: '<Sin Proyecto>', value: null});\n  }\n  _parseProductos(productos) {\n    this.productosDisponibles = productos.map((prod) => {\n      return {label: `${prod.Nombre}`, value: prod.IdProducto};\n    });\n  }\n\n  _mapSelected(ut, model) {\n    this.sprintsDisponibles.forEach(function(element) {\n      if (element.value == ut.UT.IdVersion) model.IdVersion = element.value;\n    });\n    this.workflowsDisponibles.forEach(function(element) {\n      if (element.value == ut.UT.IdWorkflow) model.IdWorkflow = element.value;\n    });\n    this.tiposDisponibles.forEach(function(element) {\n      if (element.value == ut.UT.IdTipoUT) model.IdTipoUT = element.value;\n    });\n    this.proyectosDisponibles.forEach(function(element) {\n      if (element.value == ut.UT.IdProyecto) model.IdProyecto = element.value;\n    });\n    this.productosDisponibles.forEach(function(element) {\n      if (element.value == ut.UT.IdProducto) model.IdProducto = element.value;\n    });\n  }\n\n  getUtTypeIcon = (tipo) => {\n    return utTypesIcons[tipo];\n  };\n\n  ngOnDestroy() {\n    this._saveDetailsSubscription &&\n    !this._saveDetailsSubscription.closed &&\n    this._saveDetailsSubscription.unsubscribe();\n  }\n}\n","import {Injectable} from '@angular/core';\r\nimport {HttpClient} from '@angular/common/http';\r\n\r\n@Injectable()\r\nexport class CreateUTService {\r\n  constructor(http: HttpClient) {\r\n    this._http = http;\r\n    this._url = 'UTs/Crear';\r\n  }\r\n  put(newUT) {\r\n    return this._http.put(this._url, newUT);\r\n  }\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {HttpClient} from '@angular/common/http';\r\n\r\n@Injectable()\r\nexport class GetProductosService {\r\n  constructor(http: HttpClient) {\r\n    this._http = http;\r\n    this._url = 'Productos2';\r\n  }\r\n  get() {\r\n    return this._http.get(\r\n      `${this._url}`\r\n    );\r\n  }\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {HttpClient} from '@angular/common/http';\r\n\r\n@Injectable()\r\nexport class GetWorkflowsService {\r\n  constructor(http: HttpClient) {\r\n    this._http = http;\r\n    this._url = 'Workflows';\r\n  }\r\n  get(idProducto) {\r\n    return this._http.get(\r\n      `${this._url}/${idProducto}`\r\n    );\r\n  }\r\n}\r\n\r\n","import {Component} from '@angular/core';\r\nimport {NotificationsService} from '@tune-up/core';\r\nimport {CreateUTService, GetProductosService, GetWorkflowsService} from './services';\r\nimport html from './nuevaut.component.html';\r\nimport './nuevaut.component.css';\r\n\r\n@Component({\r\n  selector: 'tn-ut-nuevaut',\r\n  template: html,\r\n  providers: [CreateUTService, GetProductosService, GetWorkflowsService],\r\n})\r\nexport class NuevaUTComponent {\r\n  ut = {\r\n    Nombre: null,\r\n    IdVersion: null,\r\n    Producto: null,\r\n    Workflow: null,\r\n    IdTipoUT: null,\r\n    IdProyecto: null,\r\n  };\r\n  productos = [];\r\n  workflows = [];\r\n  workflowsCache = [];\r\n\r\n  constructor(\r\n    createUTService: CreateUTService,\r\n    getProductosService : GetProductosService,\r\n    getWorkflowsService : GetWorkflowsService,\r\n    notificationsService: NotificationsService,\r\n  ) {\r\n    this._createUTService = createUTService;\r\n    this._getProductosService = getProductosService;\r\n    this._getWorkflowsService = getWorkflowsService;\r\n    this._notificationService = notificationsService;\r\n    this._getProductos();\r\n  }\r\n\r\n  _getProductos() {\r\n    this._getProductosSubscription = this._getProductosService.get().subscribe(\r\n      (data) => {\r\n        this.productos = data;\r\n      },\r\n      (error) =>\r\n        this._notificationService.error(\r\n          'No se han podido obtener los productos',\r\n          error\r\n        )\r\n    );\r\n  }\r\n\r\n  onProductChanged(nuevoProducto) {\r\n      this.workflows = _getWorkflows(nuevoProducto.IdProducto);\r\n  }\r\n\r\n  _getWorkflows(idProducto) {\r\n    if (!this.workflowsCache[idProducto]) {\r\n      this.workflowsCache[idProducto] = _getWorkflowsService.get(idProducto).subscribe(\r\n        (data) => {\r\n          this.workflowsCache[idProducto] = data;\r\n        }\r\n      );\r\n    }\r\n    return this.workflowsCache[idProducto];\r\n  }\r\n\r\n  _crearUT() {\r\n    idUT = 0;\r\n    this.createUTService.put(this.ut).subscribe(\r\n      (data) => {\r\n        this.idUT = data.Resultado;\r\n      },\r\n      (error) => {\r\n        this._notificationService.error(\r\n          'No se pudo crear la UT especficada',\r\n          error\r\n        );\r\n      }\r\n    );\r\n    return idUT;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this._getProductosSubscription &&\r\n      !this._getProductosSubscription.closed &&\r\n      this._getProductosSubscription.unsubscribe();\r\n  }\r\n}\r\n","import {RouterModule} from '@angular/router';\r\nimport {NgModule} from '@angular/core';\r\nimport {UtComponent} from './ut.component';\r\nimport {DetailsComponent, NuevaUTComponent} from './components';\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild([\r\n    {path: '', component: UtComponent},\r\n    {path: 'add', component: NuevaUTComponent},\r\n    {path: ':id', component: DetailsComponent},\r\n  ])],\r\n  exports: [RouterModule],\r\n})\r\nexport class UtRoutingModule {}\r\n\r\n\r\n","import {NgModule} from '@angular/core';\r\nimport {UtRoutingModule} from './ut.routing';\r\nimport {UtComponent} from './ut.component';\r\nimport {TuneUpCoreModule} from '@tune-up/core';\r\nimport {DetailsComponent, DetailsService, NuevaUTComponent} from './components';\r\n\r\n@NgModule({\r\n  imports: [TuneUpCoreModule, UtRoutingModule],\r\n  declarations: [\r\n    UtComponent,\r\n    DetailsComponent,\r\n    NuevaUTComponent,\r\n  ],\r\n  providers: [\r\n    DetailsService,\r\n  ],\r\n})\r\nexport class UtModule {}\r\n"],"names":["UtComponent","Component","DetailsService","Injectable","http","_http","_urlUT","_urlProductos","_urlUTs","id","this","get","model","post","HttpClient","utTypesIcons","DetailsComponent","route","detailsService","notificationsService","editingMode","IdUT","undefined","Nombre","Orden","IdVersion","IdWorkflow","IdProyecto","Descripcion","ut","onGuardar","_saveDetailsSubscription","_this","_detailsService","submitChangesDetails","subscribe","data","error","_notificationsService","getUtTypeIcon","tipo","_route","parseInt","params","_value","getProductosDisponibles","_parseProductos","getUt","UT","_parseSprints","listaVersionesUT","_parseWorkflows","listaWorkflowsDisponibles","_parseTipos","listaTiposUT","_parseProyectos","listaProyectos","_mapSelected","_getUtSub","closed","unsubscribe","IdProducto","IdTipoUT","sprints","sprintsDisponibles","map","sprint","label","value","push","wfs","workflowsDisponibles","wf","tipos","tiposDisponibles","proyectos","proyectosDisponibles","proy","productos","productosDisponibles","prod","forEach","element","ActivatedRoute","NotificationsService","CreateUTService","_url","newUT","put","GetProductosService","GetWorkflowsService","idProducto","NuevaUTComponent","createUTService","getProductosService","getWorkflowsService","workflows","workflowsCache","_createUTService","_getProductosService","_getWorkflowsService","_notificationService","_getProductos","_getProductosSubscription","nuevoProducto","_getWorkflows","idUT","Resultado","UtRoutingModule","NgModule","RouterModule","forChild","path","component","UtModule","TuneUpCoreModule"],"mappings":"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"}